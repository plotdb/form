<div><div><plug name="view"></plug></div><hr><div>control panel</div><hr><div class="mb-2 d-flex"><div class="flex-grow-1"><div>title</div><input class="form-control" ld="title"></div><div class="ml-4"><div>alias</div><select class="form-control" ld="alias"><option value="uid">統編</option><option value="teamname">單位名稱</option><option value="teamname">自訂..</option></select></div></div><div class="mb-2"><div>description</div><textarea class="form-control" rows="5" ld="desc"></textarea></div><div class="d-flex mb-2 align-items-center"><div class="d-flex align-items-center mr-4"><span>isRequired</span><div class="switch ml-1" ld="switch" data-name="isRequired"></div></div><div class="d-flex align-items-center mr-4"><span>isPublic</span><div class="switch ml-1" ld="switch" data-name="isPublic"></div></div><div class="d-flex align-items-center mr-4"><span>showDesc</span><div class="switch ml-1" ld="switch" data-name="showDesc"></div></div></div><div class="mb-2"><div>critera</div><div class="d-flex mb-2"><div class="mr-2"><div>attr</div><select class="form-control mr-2" ld="picked-attr"><option ld-each="attr">number</option></select></div><div class="mr-2"><div>op</div><select class="form-control mr-2" ld="picked-op"><option ld-each="op">between</option></select></div><div class="mr-2 flex-grow-1" ld-each="op-config"><div ld="name">name</div><input class="form-control mr-2" ld="value" value="1"></div><div><div>&nbsp;</div><div class="btn btn-outline-primary" ld="add-criteria"><i class="i-plus"></i></div></div></div><hr><div class="d-flex mb-2 align-items-center" ld-each="criteria"><div class="mr-2"><div>&nbsp;</div><div class="switch switch-lg" ld="enabled"></div></div><div class="mr-2"><div>attr</div><select class="form-control mr-2" ld="attr"><option ld-each="attr-option">number</option></select></div><div class="mr-2"><div>op</div><select class="form-control mr-2" ld="op"><option ld-each="op-option">between</option></select></div><div class="mr-2 flex-grow-1" ld-each="op-config"><div ld="name">name</div><input class="form-control mr-2" ld="value" value="1"></div><div><div>&nbsp;</div><div class="btn btn-outline-danger" ld="delete"><i class="i-close"></i></div></div></div></div><script type="@plotdb/block">({pkg:{name:"@plotdb/formbase",version:"0.0.1"},init:function(t){var e;e=t.root;console.log("formbase");return function(t){return new t}(function(){var i,r,n=this;this.root=e;i=this.data={};return this.view=r=new ldView({root:this.root,action:{input:{title:function(t){var e;e=t.node;return i.title=e.value||""},desc:function(t){var e;e=t.node;return i.desc=e.value||""},value:function(t){var e;e=t.node;i.value=e.value;return i.criteria.map(function(){return form.term})}},click:{"add-criteria":function(){i.criteria.push({});return n.view.render("criteria")},switch:function(t){var e,n;e=t.node;n=e.getAttribute("data-name");if(!(n==="isPublic"||n==="isRequired"||n==="showDesc")){return}i[n]=!i[n];return r.render()}}},handler:{title:function(t){var e;e=t.node;return e.value=i.title||""},desc:function(t){var e;e=t.node;return e.value=i.desc||""},switch:function(t){var e,n;e=t.node;n=e.getAttribute("data-name");if(!(n==="isPublic"||n==="isRequired"||n==="showDesc")){return}return e.classList.toggle("on",!!i[n])},attr:{list:function(){var n,r;return function(){var t,e=[];for(n in t=i.attr){r=t[n];e.push({k:n,v:r})}return e}()||[]},handler:function(t){var e,n;e=t.node,n=t.data;e.setAttribute("value",n.k);return e.innerText=n.v.name}},criteria:{list:function(){return i.criteria||[]},view:{action:{click:{enabled:function(t){var e;e=t.context;e.enabled=!e.enabled;return n.view.render("criteria")},delete:function(t){var e;e=t.context;i.criteria.splice(i.criteria.indexOf(e),1);return n.view.render("criteria")}},change:{attr:function(t){var e,n;e=t.node,n=t.context;n.opset=i.attr[e.value].opset;return r.render("criteria")},op:function(t){var e,n;e=t.node,n=t.context;n.op=form.opset.get(n.opset||"number").getOp(e.value);return r.render("criteria")}}},handler:{enabled:function(t){var e,n;e=t.node,n=t.context;return e.classList.toggle("on",!!n.enabled)},"attr-option":{list:function(){var n,r;return function(){var t,e=[];for(n in t=i.attr){r=t[n];e.push({k:n,v:r})}return e}()||[]},key:function(t){return t.k},handler:function(t){var e,n;e=t.node,n=t.data;e.setAttribute("value",n.k);return e.innerText=n.v.name}},"op-option":{list:function(t){var e,n,r,i,o,a=[];e=t.context;n=form.opset.get(e.opset||"number");for(r in i=n.ops){o=i[r];a.push(o)}return a},handler:function(t){var e,n;e=t.node,n=t.data;e.setAttribute("value",n.id);return e.innerText=n.name}},"op-config":{list:function(t){var e,n,r,i,o=[];e=t.context;for(n in r=(e.op||(e.op={})).config||{}){i=r[n];o.push({k:n,v:i})}return o},key:function(t){return t.k},view:{text:{name:function(t){var e,n;e=t.node,n=t.context;return n.k}}}}}}}}})})}});</script></div>