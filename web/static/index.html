<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Roboto+Mono"><link rel="stylesheet" type="text/css" href="assets/lib/bootstrap/main/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldiconfont/main/ldif.min.css"><link rel="stylesheet" type="text/css" href="css/index.css"></head><body><div class="w-1024 rwd mx-auto my-4" id="root"><div class="d-flex mb-4"><div class="btn btn-outline-secondary mr-2" ld="serialize">serialize</div><div class="btn btn-outline-secondary mr-2" ld="value">get value</div><div class="btn btn-outline-secondary mr-2" ld="mode" data-name="edit">edit</div><div class="btn btn-outline-secondary mr-2" ld="mode" data-name="view">view</div><div class="btn btn-outline-secondary mr-2" ld="set">random value</div></div></div><script type="text/javascript" src="assets/lib/bootstrap.native/main/bootstrap-native.min.js"></script><script type="text/javascript" src="assets/lib/i18next/main/umd/i18next.min.js"></script><script type="text/javascript" src="assets/lib/@loadingio/debounce.js/main/debounce.min.js"></script><script type="text/javascript" src="assets/lib/@loadingio/ldquery/main/ldq.min.js"></script><script type="text/javascript" src="assets/lib/proxise/main/proxise.min.js"></script><script type="text/javascript" src="assets/lib/ldcover/main/index.min.js"></script><script type="text/javascript" src="assets/lib/ldview/main/index.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/datadom/main/datadom.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/datahub/main/datahub.bundle.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/csscope/main/csscope.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/rescope/main/rescope.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/block/main/block.min.js"></script><script type="text/javascript" src="assets/lib/@plotdb/form/dev/form.min.js"></script><script>(function(it){
  return it.apply({});
})(function(){
  var manager, fmgr, this$ = this;
  manager = new block.manager({
    registry: function(arg$){
      var name, version, path, type;
      name = arg$.name, version = arg$.version, path = arg$.path, type = arg$.type;
      if (type === 'block') {
        return "/block/" + name + "/" + version + "/" + (path || 'index.html');
      }
      return "/assets/lib/" + name + "/" + version + "/" + (path || 'index.js');
    }
  });
  this.fields = [];
  fmgr = new form.manager();
  return i18next.init({
    fallbackLng: 'zh-TW',
    defaultLng: 'zh-TW'
  }).then(function(){
    return i18next.changeLanguage('zh-TW');
  }).then(function(){
    block.i18n.use(i18next);
    return manager.init();
  }).then(function(){
    this$.view = new ldview({
      root: document,
      action: {
        click: {
          serialize: function(){
            return console.log(fmgr.serialize());
          },
          mode: function(arg$){
            var node;
            node = arg$.node;
            return fmgr.mode(node.getAttribute('data-name'));
          },
          value: function(arg$){
            var node;
            node = arg$.node;
            return console.log(fmgr.value());
          },
          set: function(arg$){
            var node, obj, k, v;
            node = arg$.node;
            obj = fmgr.value();
            for (k in obj) {
              v = obj[k];
              console.log(k, v);
              if (k === 'choice') {
                obj[k] = 'option 1';
              } else {
                obj[k] = Math.random();
              }
            }
            return fmgr.value(obj);
          }
        }
      }
    });
    return Promise.all(['short-answer', 'single-choice', 'multi-choice'].map(function(name){
      return manager.get({
        name: name,
        version: '0.0.1'
      }).then(function(it){
        return it.create({
          data: {
            data: 'hello world'
          }
        });
      }).then(function(it){
        it.attach({
          root: root
        });
        return it['interface']();
      }).then(function(it){
        return it;
      });
    }));
  }).then(function(it){
    console.log(it);
    return fmgr.add(it);
  });
});</script></body></html>