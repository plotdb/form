<div><div class="form-sheet" ld-scope plug="view"></div><script type="@plotdb/block">({pkg:{name:"sheet",version:"0.0.1",extend:{name:"base",version:"0.0.1"},license:"MIT",description:"",dependencies:[{url:"/assets/lib/@plotdb/sheet/main/index.min.css"},{url:"/assets/lib/@plotdb/sheet/main/index.min.js"}],i18n:{en:{rowCount:"row count",colCount:"column count"},"zh-TW":{sheet:"試算表",rowCount:"列數",colCount:"行數"}}},init:function(n){var e,t,i,r,a,u,l,o;e=n.root,t=n.parent,i=n.context,r=n.pubsub;a=i.form,u=i.sheet;r.on("change",function(){});r.on("update",function(){});l=t.node();o=new u({root:l});o.on("update",function(){return t.value(o.data,false,true)});return t.opsets.push(new a.opset({id:"sheet",ops:{rowCount:{func:function(n,e){var t,i,r,a;n==null&&(n=[]);e==null&&(e={});if(!Array.isArray(n)||isNaN(e.min)||isNaN(e.max)){return false}t=0;for(i=0,r=n.length;i<r;++i){a=i;if(Array.isArray(n[a])&&n[a].length&&n[a].filter(u).length){t=a+1}}return t>=+e.min&&t<=+e.max;function u(n){return n!=null&&n!==""}},config:{min:{type:"text",name:"min",hint:"minimal value"},max:{type:"text",name:"max",hint:"maximal value"}}},colCount:{func:function(n,e){var t,i,r,a,u,l,o,s,m;n==null&&(n=[]);e==null&&(e={});if(!Array.isArray(n)||isNaN(e.min)||isNaN(e.max)){return false}t=false;for(i=0,r=n.length;i<r;++i){a=i;u=n[a]||[];if(!(Array.isArray(u)&&u.length&&u.filter(f).length)){continue}l=0;t=true;if(Array.isArray(u)){for(o=0,s=u.length;o<s;++o){m=o;if(u[m]!=null&&u[m]!==""){l=m+1}}}if(l<+e.min||l>+e.max){return false}}return t;function f(n){return n!=null&&n!==""}},config:{min:{type:"text",name:"min",hint:"minimal value"},max:{type:"text",name:"max",hint:"maximal value"}}}}}))}});</script><style type="text/css">[plug=view]{position:relative;padding-top:50%;border:1px solid #ccc}[plug=view] .sheet{position:absolute;top:0;left:0}</style></div>